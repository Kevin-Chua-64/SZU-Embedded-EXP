C51 COMPILER V9.02   LCD1602                                                               11/15/2022 22:11:26 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE LCD1602
OBJECT MODULE PLACED IN .\Obj\lcd1602.obj
COMPILER INVOKED BY: D:\Keil\C51\BIN\C51.EXE App\lcd1602\lcd1602.c BROWSE INCDIR(.\App\lcd1602;.\Public) DEBUG OBJECTEXT
                    -END PRINT(.\Obj\lcd1602.lst) OBJECT(.\Obj\lcd1602.obj)

line level    source

   1          #include "lcd1602.h"
   2          
   3          unsigned char read_lcd1602_state()  //读单片机是否为繁忙的状态
   4          {
   5   1              unsigned char tmp, state=0;
   6   1              LCD1602_RS = 0;  // 命令
   7   1              LCD1602_RW = 1;  // 读
   8   1              LCD1602_E = 1;
   9   1              tmp = LCD1602_DATAPORT;
  10   1              state = (tmp&0x80);      // 只看最高位
  11   1              LCD1602_E = 0;
  12   1              return state;  // 为0则为不繁忙
  13   1      }
  14          
  15          void lcd1602_write_cmd(unsigned char cmd)  // 写指令
  16          {
  17   1              while(read_lcd1602_state());  // 等待LCD退出繁忙状态
  18   1              LCD1602_RS = 0;  // 命令
  19   1              LCD1602_RW = 0;  // 写
  20   1              LCD1602_E = 0;
  21   1              LCD1602_DATAPORT = cmd;  // 先把指令送到IO
  22   1              LCD1602_E = 1;
  23   1              delay_ms(1);
  24   1              LCD1602_E = 0;
  25   1      }
  26          
  27          void lcd1602_write_data(unsigned char dat)      // 写数据
  28          {
  29   1              while(read_lcd1602_state());  // 等待LCD退出繁忙状态
  30   1              LCD1602_RS = 1;  // 数据
  31   1              LCD1602_RW = 0;  // 写
  32   1              LCD1602_E = 0;
  33   1              LCD1602_DATAPORT = dat;  // 先把数据送到IO
  34   1              LCD1602_E = 1;
  35   1              delay_ms(1);
  36   1              LCD1602_E = 0;
  37   1      }
  38          
  39          void cursor_pos_set(unsigned char x,unsigned char y)  // 设置光标的位置
  40          {
  41   1              unsigned char address;
  42   1              //x 代表列，y 代表行，写入地址时要求最高位为1，即加上0x80
  43   1              if (y>1 || x>15) return;  // 行列参数不对则强制退出
  44   1              else if (y==0) address = 0x80+x;  // 显示在第一行
  45   1              else if (y==1) address = 0x80+0x40+x;  // 显示在第二行
  46   1              lcd1602_write_cmd(address);
  47   1      }                  
  48          
  49          void lcd1602_init(void)
  50          {
  51   1              lcd1602_write_cmd(0x38);  // 数据总线8位，显示2行，5*7点阵/字符
  52   1              lcd1602_write_cmd(0x0c);  // 显示功能开，无光标，光标闪烁
  53   1              lcd1602_write_cmd(0x06);  // 写入新数据后光标右移，显示屏不移动
  54   1              lcd1602_write_cmd(0x01);  // 清屏       
C51 COMPILER V9.02   LCD1602                                                               11/15/2022 22:11:26 PAGE 2   

  55   1      }
  56          
  57          void lcd1602_clear(void)
  58          {
  59   1              lcd1602_write_cmd(0x01);        
  60   1      }
  61          
  62          void lcd1602_show_string(char *str)
  63          {
  64   1              while(*str != '\0')  // 字符串是以'\0'结尾，只要前面有内容就显示
  65   1              {
  66   2              lcd1602_write_data(*str);
  67   2                      str++;  // 指针递增
  68   2              }
  69   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    162    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
